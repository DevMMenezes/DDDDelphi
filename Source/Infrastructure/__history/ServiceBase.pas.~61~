unit ServiceBase;

interface

uses IServiceBase,
  SimpleInterface,
  SimpleDAO,
  SimpleAttributes,
  SimpleQueryFiredac,
  Produto.Entity,
  Data.DB;

type
  TServiceBase<T> = class(TInterfacedObject, IService)
  public
    class function New: IService;
    function FindAll(): TDataSet;
    function FindByID(ADataSet: TDataSet): TDataSet;
    function Insert(): IService;
    function Update(): IService;
    function Delete(): IService;
  end;

implementation

uses
  Produto.Service, System.SysUtils, DMDataModule, Main;

{ TServiceBase<T> }

function TServiceBase<T>.Delete: IService;
begin

end;

function TServiceBase<T>.FindAll(): TDataSet;
var
  Con: iSimpleQuery;
  DAOEntity: iSimpleDAO<TProdutoEntity>;
  DataSource: TDataSource;
begin
  DataSource := TDataSource.Create(nil);

  try
    try
      Con := TSimpleQueryFiredac.New(DMData.FBConnection);
      DAOEntity := TSimpleDAO<TProdutoEntity>.New(Con)
        .DataSource(DataSource).Find();
      Result := DataSource.DataSet;

    except
      on E: Exception do
        raise Exception.Create(E.Message);
    end;
  finally
    DataSource.Free;
  end;

end;

function TServiceBase<T>.FindByID(ADataSet: TDataSet): TDataSet;
begin

end;

function TServiceBase<T>.Insert: IService;
begin

end;

class function TServiceBase<T>.New: IService;
begin

  Result := Self.Create;
end;

function TServiceBase<T>.Update: IService;
begin

end;

end.
